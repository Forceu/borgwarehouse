version: '3'
services:
    borgwarehouse:
        # UID:GID must match the user and group ID of the host folders and must be >= 1001
        user: '1001:1001'
        build:
            context: .
            dockerfile: Dockerfile
        image: borgwarehouse
        ports:
            - '3000:3000'
            - '2222:22'
        environment:
            - NEXTAUTH_URL=https://your.domain.com
            - NEXTAUTH_SECRET=your-secret
            - CRONJOB_KEY=your-other-secret
            # The SSH_SERVER_PORT must match the port exposed above
            - SSH_SERVER_PORT=2222
            - FQDN=your.domain.com
        volumes:
            # The host folders must be owned by the user with UID and GID specified above
            - <host-folder>/config:/home/borgwarehouse/app/config
            - <host-folder>/ssh:/home/borgwarehouse/.ssh
            - <host-folder>/ssh_host:/etc/ssh
            - <host-folder>/repos:/home/borgwarehouse/repos
        container_name: borgwarehouse
